2020-01-05 18:30:06 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:30:06 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:30:06 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:30:06 INFO     [apscheduler.scheduler._real_add_job] Added job "NacionalDepartamental" to job store "default"
2020-01-05 18:30:06 INFO     [apscheduler.scheduler._real_add_job] Added job "MunicipiosConsulta" to job store "default"
2020-01-05 18:30:06 INFO     [apscheduler.scheduler._real_add_job] Added job "ConsultaSNIS" to job store "default"
2020-01-05 18:30:06 INFO     [apscheduler.scheduler.start] Scheduler started
2020-01-05 18:30:33 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:30:33 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:30:33 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:30:33 INFO     [apscheduler.scheduler._real_add_job] Added job "NacionalDepartamental" to job store "default"
2020-01-05 18:30:33 INFO     [apscheduler.scheduler._real_add_job] Added job "MunicipiosConsulta" to job store "default"
2020-01-05 18:30:33 INFO     [apscheduler.scheduler._real_add_job] Added job "ConsultaSNIS" to job store "default"
2020-01-05 18:30:33 INFO     [apscheduler.scheduler.start] Scheduler started
2020-01-05 18:31:00 INFO     [apscheduler.executors.default.run_job] Running job "NacionalDepartamental (trigger: cron[minute='31'], next run at: 2020-05-01 18:31:00 -04)" (scheduled at 2020-05-01 18:31:00-04:00)
2020-01-05 18:31:00 INFO     [__main__.NacionalDepartamental] Consulta general y departamental
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.Consulta] Se realizo la consulta : 30/04/20 20:50
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.Consulta] Se guardo la consulta en formato JSON
2020-01-05 18:31:15 INFO     [numexpr.utils._init_num_threads] NumExpr defaulting to 4 threads.
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.Consulta]   depto  confirmados  decesos  ...  total       fecha  activos
0    LP          218       15  ...   1657  2020-04-30      176
1    CB           80        6  ...   1139  2020-04-30       49
2    SC          656       32  ...   2942  2020-04-30      574
3    OR          102        6  ...    418  2020-04-30       86
4    PT           26        1  ...    181  2020-04-30       23
5    TJ            3        0  ...     54  2020-04-30        3
6    CH            3        0  ...    136  2020-04-30        3
7    BN           67        1  ...    175  2020-04-30       66
8    PN           12        1  ...     96  2020-04-30        5

[9 rows x 9 columns]
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.Consulta] confirmados          1167
decesos                62
recuperados           120
sospechosos            65
descartados          5384
total                6798
fecha          2020-04-30
depto                 BOL
activos               985
dtype: object
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.ReportDaily] Se generaron los reportes diarios
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.ReportDaily] Se actualizaron las serie de tiempo
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.TotalDepto] Se actualizo el reporte COVID19_BOL_depto
2020-01-05 18:31:15 INFO     [Infraestructure.Services.NewRecord.TotalNacional] Se actualizo el reporte COVID19_BOL
2020-01-05 18:31:23 INFO     [Infraestructure.Services.NewRecord.AutoCommit] Se ejecuto el autocommit correctamente
2020-01-05 18:31:23 INFO     [__main__.NacionalDepartamental] Se registro nuevo día NACIONAL y DEPARTAMENTAL
2020-01-05 18:31:23 INFO     [apscheduler.executors.default.run_job] Job "NacionalDepartamental (trigger: cron[minute='31'], next run at: 2020-05-01 19:31:00 -04)" executed successfully
2020-01-05 18:32:00 INFO     [apscheduler.executors.default.run_job] Running job "ConsultaSNIS (trigger: cron[hour='18', minute='32'], next run at: 2020-05-01 18:32:00 -04)" (scheduled at 2020-05-01 18:32:00-04:00)
2020-01-05 18:32:00 INFO     [__main__.ConsultaSNIS] Consulta de los reportes SNIS
2020-01-05 18:32:03 ERROR    [apscheduler.executors.default.run_job] Job "ConsultaSNIS (trigger: cron[hour='18', minute='32'], next run at: 2020-05-02 18:32:00 -04)" raised an exception
Traceback (most recent call last):
  File "/home/mavino/anaconda3/lib/python3.7/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "AppScheduler.py", line 60, in ConsultaSNIS
    reporte.GetReporte()
  File "/home/mavino/Documents/COVID_test/Infraestructure/Services/NewRecord.py", line 419, in GetReporte
    with open("ReporteSNIS/{}.pdf".format(now_time.strftime("%Y-%m-%d_%H_%M")) , "wb") as a:
FileNotFoundError: [Errno 2] No such file or directory: 'ReporteSNIS/2020-05-01_18_32.pdf'
2020-01-05 18:33:09 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:33:09 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:33:09 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:33:09 INFO     [apscheduler.scheduler._real_add_job] Added job "NacionalDepartamental" to job store "default"
2020-01-05 18:33:09 INFO     [apscheduler.scheduler._real_add_job] Added job "MunicipiosConsulta" to job store "default"
2020-01-05 18:33:09 INFO     [apscheduler.scheduler._real_add_job] Added job "ConsultaSNIS" to job store "default"
2020-01-05 18:33:09 INFO     [apscheduler.scheduler.start] Scheduler started
2020-01-05 18:34:00 INFO     [apscheduler.executors.default.run_job] Running job "ConsultaSNIS (trigger: cron[hour='18', minute='34'], next run at: 2020-05-01 18:34:00 -04)" (scheduled at 2020-05-01 18:34:00-04:00)
2020-01-05 18:34:00 INFO     [__main__.ConsultaSNIS] Consulta de los reportes SNIS
2020-01-05 18:34:00 INFO     [Infraestructure.Services.NewRecord.GetReporte] Se guardo el reporte del SNIS
2020-01-05 18:34:06 INFO     [Infraestructure.Services.NewRecord.AutoCommit] Se ejecuto el autocommit correctamente
2020-01-05 18:34:06 INFO     [apscheduler.executors.default.run_job] Job "ConsultaSNIS (trigger: cron[hour='18', minute='34'], next run at: 2020-05-02 18:34:00 -04)" executed successfully
2020-01-05 18:36:55 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:36:55 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:36:55 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-01-05 18:36:55 INFO     [apscheduler.scheduler._real_add_job] Added job "NacionalDepartamental" to job store "default"
2020-01-05 18:36:55 INFO     [apscheduler.scheduler._real_add_job] Added job "MunicipiosConsulta" to job store "default"
2020-01-05 18:36:55 INFO     [apscheduler.scheduler._real_add_job] Added job "ConsultaSNIS" to job store "default"
2020-01-05 18:36:55 INFO     [apscheduler.scheduler.start] Scheduler started
2020-01-05 18:37:00 INFO     [apscheduler.executors.default.run_job] Running job "MunicipiosConsulta (trigger: cron[hour='1,5,9,13,18,21,23', minute='37'], next run at: 2020-05-01 18:37:00 -04)" (scheduled at 2020-05-01 18:37:00-04:00)
2020-01-05 18:37:00 INFO     [__main__.MunicipiosConsulta] Ejecutando la nueva consulta municipal
2020-01-05 18:37:01 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] https://juliael.carto.com/builder/c70fa175-3e6a-4955-8088-89048c6e6886/embed
2020-01-05 18:37:13 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] Se consultara el mapa: d557d29d@c4a28d38165ad2ecccdfa700d2524bd6:1588297606104
2020-01-05 18:37:17 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] Se tienen {'errors': ["You are over platform's limits: too many requests. Please contact us to know more details"], 'errors_with_context': [{'type': 'limit', 'message': "You are over platform's limits: too many requests. Please contact us to know more details", 'subtype': 'rate-limit'}]} municipios
2020-01-05 18:37:54 INFO     [Infraestructure.Services.NewRecord.Municipios] 10.0 \% de Consultas
2020-01-05 18:38:30 INFO     [Infraestructure.Services.NewRecord.Municipios] 20.0 \% de Consultas
2020-01-05 18:39:06 INFO     [Infraestructure.Services.NewRecord.Municipios] 30.0 \% de Consultas
2020-01-05 18:39:42 INFO     [Infraestructure.Services.NewRecord.Municipios] 40.0 \% de Consultas
2020-01-05 18:40:17 INFO     [Infraestructure.Services.NewRecord.Municipios] 50.0 \% de Consultas
2020-01-05 18:40:54 INFO     [Infraestructure.Services.NewRecord.Municipios] 60.0 \% de Consultas
2020-01-05 18:41:29 INFO     [Infraestructure.Services.NewRecord.Municipios] 70.0 \% de Consultas
2020-01-05 18:42:04 INFO     [Infraestructure.Services.NewRecord.Municipios] 80.0 \% de Consultas
2020-01-05 18:42:37 INFO     [Infraestructure.Services.NewRecord.Municipios] 90.0 \% de Consultas
2020-01-05 18:43:13 INFO     [Infraestructure.Services.NewRecord.Municipios] 100.0 \% de Consultas
2020-01-05 18:43:13 INFO     [numexpr.utils._init_num_threads] NumExpr defaulting to 4 threads.
2020-01-05 18:43:13 INFO     [Infraestructure.Services.NewRecord.Municipios] Los municipios corresponden a una fecha válida
2020-01-05 18:43:13 INFO     [Infraestructure.Services.NewRecord.Municipios] Se inserto una nueva fecha
2020-01-05 18:43:18 INFO     [Infraestructure.Services.NewRecord.AutoCommit] Se ejecuto el autocommit correctamente
2020-01-05 18:43:18 INFO     [__main__.MunicipiosConsulta] Se agrego exitosamente la consulta MUNICIPAL
2020-01-05 18:43:18 INFO     [apscheduler.executors.default.run_job] Job "MunicipiosConsulta (trigger: cron[hour='1,5,9,13,18,21,23', minute='37'], next run at: 2020-05-01 21:37:00 -04)" executed successfully
2020-01-05 19:31:00 INFO     [apscheduler.executors.default.run_job] Running job "NacionalDepartamental (trigger: cron[minute='31'], next run at: 2020-05-01 20:31:00 -04)" (scheduled at 2020-05-01 19:31:00-04:00)
2020-01-05 19:31:00 INFO     [__main__.NacionalDepartamental] Consulta general y departamental
2020-01-05 19:31:01 INFO     [Infraestructure.Services.NewRecord.Consulta] Se realizo la consulta : 30/04/20 20:50
2020-01-05 19:31:01 INFO     [__main__.NacionalDepartamental] No se tienen nuevos días a registrar NACIONAL y DEPARTAMENTAL
2020-01-05 19:31:01 INFO     [apscheduler.executors.default.run_job] Job "NacionalDepartamental (trigger: cron[minute='31'], next run at: 2020-05-01 20:31:00 -04)" executed successfully
2020-02-05 18:39:14 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-02-05 18:39:14 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-02-05 18:39:14 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-02-05 18:39:14 INFO     [apscheduler.scheduler._real_add_job] Added job "NacionalDepartamental" to job store "default"
2020-02-05 18:39:14 INFO     [apscheduler.scheduler._real_add_job] Added job "MunicipiosConsulta" to job store "default"
2020-02-05 18:39:14 INFO     [apscheduler.scheduler._real_add_job] Added job "ConsultaSNIS" to job store "default"
2020-02-05 18:39:14 INFO     [apscheduler.scheduler.start] Scheduler started
2020-02-05 18:40:00 INFO     [apscheduler.executors.default.run_job] Running job "MunicipiosConsulta (trigger: cron[hour='1,3,5,7,9,11,13,15,18,21,23', minute='15,40'], next run at: 2020-05-02 18:40:00 -04)" (scheduled at 2020-05-02 18:40:00-04:00)
2020-02-05 18:40:00 INFO     [__main__.MunicipiosConsulta] Ejecutando la nueva consulta municipal
2020-02-05 18:40:01 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] https://datosagt2020.carto.com/builder/c1cdf57c-a007-4f3f-883a-c25ebdc50986/embed
2020-02-05 18:40:12 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] Se consultara el mapa: 3d4d59de@caa3b58780e8be73073ffc8dee28b1e7:1588388363912
2020-02-05 18:40:13 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] Se tienen {'errors': ["Dataview 'eac18df0-661c-4c8f-a7c6-532c7ed3b5bf' does not exist"], 'errors_with_context': [{'type': 'dataview', 'message': "Dataview 'eac18df0-661c-4c8f-a7c6-532c7ed3b5bf' does not exist"}]} municipios
2020-02-05 18:40:41 INFO     [Infraestructure.Services.NewRecord.Municipios] 20.0 \% de Consultas
2020-02-05 18:40:59 ERROR    [apscheduler.executors.default.run_job] Job "MunicipiosConsulta (trigger: cron[hour='1,3,5,7,9,11,13,15,18,21,23', minute='15,40'], next run at: 2020-05-02 21:15:00 -04)" raised an exception
Traceback (most recent call last):
  File "/home/mavino/anaconda3/lib/python3.7/site-packages/apscheduler/executors/base.py", line 125, in run_job
    retval = job.func(*job.args, **job.kwargs)
  File "AppScheduler.py", line 51, in MunicipiosConsulta
    A.Municipios(mapa_id)
  File "/home/mavino/Documents/COVID_test/Infraestructure/Services/NewRecord.py", line 355, in Municipios
    CONSULTA_i["date_get"] = pd.to_datetime(CONSULTA_i.date_get).dt.strftime("%Y-%m-%d %H:%M")
  File "/home/mavino/anaconda3/lib/python3.7/site-packages/pandas/core/generic.py", line 5274, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'date_get'
2020-02-05 18:43:07 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-02-05 18:43:07 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-02-05 18:43:07 INFO     [apscheduler.scheduler.add_job] Adding job tentatively -- it will be properly scheduled when the scheduler starts
2020-02-05 18:43:07 INFO     [apscheduler.scheduler._real_add_job] Added job "NacionalDepartamental" to job store "default"
2020-02-05 18:43:07 INFO     [apscheduler.scheduler._real_add_job] Added job "MunicipiosConsulta" to job store "default"
2020-02-05 18:43:07 INFO     [apscheduler.scheduler._real_add_job] Added job "ConsultaSNIS" to job store "default"
2020-02-05 18:43:07 INFO     [apscheduler.scheduler.start] Scheduler started
2020-02-05 18:44:00 INFO     [apscheduler.executors.default.run_job] Running job "MunicipiosConsulta (trigger: cron[hour='1,3,5,7,9,11,13,15,18,21,23', minute='15,44'], next run at: 2020-05-02 18:44:00 -04)" (scheduled at 2020-05-02 18:44:00-04:00)
2020-02-05 18:44:00 INFO     [__main__.MunicipiosConsulta] Ejecutando la nueva consulta municipal
2020-02-05 18:44:01 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] https://datosagt2020.carto.com/builder/c1cdf57c-a007-4f3f-883a-c25ebdc50986/embed
2020-02-05 18:44:12 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] Se consultara el mapa: 3d4d59de@caa3b58780e8be73073ffc8dee28b1e7:1588388363912
2020-02-05 18:44:12 INFO     [Infraestructure.Services.NewRecord.ExtraerIDmapa] Se tienen {'errors': ["Dataview 'eac18df0-661c-4c8f-a7c6-532c7ed3b5bf' does not exist"], 'errors_with_context': [{'type': 'dataview', 'message': "Dataview 'eac18df0-661c-4c8f-a7c6-532c7ed3b5bf' does not exist"}]} municipios
2020-02-05 18:44:39 INFO     [Infraestructure.Services.NewRecord.Municipios] 20.0 \% de Consultas
2020-02-05 18:44:56 INFO     [numexpr.utils._init_num_threads] NumExpr defaulting to 4 threads.
2020-02-05 18:45:00 INFO     [apscheduler.executors.default.run_job] Running job "NacionalDepartamental (trigger: cron[minute='5,20,45'], next run at: 2020-05-02 18:45:00 -04)" (scheduled at 2020-05-02 18:45:00-04:00)
2020-02-05 18:45:00 INFO     [__main__.NacionalDepartamental] Consulta general y departamental
2020-02-05 18:45:01 INFO     [Infraestructure.Services.NewRecord.Consulta] Se realizo la consulta : 01/05/20 21:11
2020-02-05 18:45:01 INFO     [__main__.NacionalDepartamental] No se tienen nuevos días a registrar NACIONAL y DEPARTAMENTAL
2020-02-05 18:45:01 INFO     [apscheduler.executors.default.run_job] Job "NacionalDepartamental (trigger: cron[minute='5,20,45'], next run at: 2020-05-02 19:05:00 -04)" executed successfully
2020-02-05 18:45:01 INFO     [Infraestructure.Services.NewRecord.AutoCommit] Se ejecuto el autocommit correctamente
2020-02-05 18:45:01 INFO     [__main__.MunicipiosConsulta] Se agrego exitosamente la consulta MUNICIPAL
2020-02-05 18:45:01 INFO     [apscheduler.executors.default.run_job] Job "MunicipiosConsulta (trigger: cron[hour='1,3,5,7,9,11,13,15,18,21,23', minute='15,44'], next run at: 2020-05-02 21:15:00 -04)" executed successfully
